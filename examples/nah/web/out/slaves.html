<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Overview</title><link href=styles.css rel=stylesheet></head><body><div class=container><div class=sidebar><div class=menu-section><h3 class="menu-header active">Overview</h3><ul><li><a href=/>Overview</a></li><li><a class=active href=/slaves.html>Slaves</a></li></ul></div><div class=menu-section><h3 class=menu-header>System</h3><ul><li><a href=/systems.html>System</a></li><li><a href=/modbus.html>Modbus</a></li><li><a href=/mqtt.html>MQTT</a></li><li><a href=/mapping.html>Mapping</a></li></ul></div><div class=menu-section><h3 class=menu-header>Network</h3><ul><li><a href=/wifi.html>WiFi</a></li><li><a href=/wan.html>WAN</a></li><li><a href=/lan.html>LAN</a></li></ul></div><div class=menu-section><h3 class=menu-header>Other</h3><ul><li><a href=/other.html>Other</a></li></ul></div></div><div class=main-content><div class="content-section active"><h2>Slaves</h2><div class=map-ping-content><div class=info-section><h3 class=section-header>Check Slave Register</h3><table class=info-table><thead><tr><th>Register address</th><th>Value</th></tr></thead><tbody id=slave_response></tbody></table><div class=button-group><div class=form-group><label>ID</label><input id=slave_id max=255 min=0 type=number value=0><label>Function</label><select id=slave_func><option value=1>1</option><option value=2>2</option><option value=3>3</option><option value=4>4</option></select><label>Num of Registers</label><select id=slave_numregs><option value=1>1</option><option value=2>2</option><option value=3>3</option><option value=4>4</option></select><label>Offset</label><input id=slave_offset min=0 type=number value=0><label id=slave_event></label></div></div><div style="justify-content: flex-end;" class=button-group><button class=save-btn id=slave_send_btn type=button>Send</button><button class=reset-btn id=slave_clear_btn type=button>Clear</button></div></div><div class=info-section><h3 class=section-header>Slave Node</h3><div class=node-navigation id=node_devices><button class="node-btn active">0x01</button><button class=node-btn>0x02</button><button class=node-btn>0x03</button><button class=node-btn>0x04</button><button class=node-btn>0x05</button></div><table class=modbus-node-table><thead><tr><th>Offset address</th><th>Function</th><th>Key</th><th>Value</th></tr></thead><tbody id=node_response></tbody></table></div></div></div></div></div></body><script>const HOST_IP=window.location.host;const slave_response=document.getElementById(`slave_response`);const slave_id=document.getElementById(`slave_id`);const slave_func=document.getElementById(`slave_func`);const slave_numregs=document.getElementById(`slave_numregs`);const slave_offset=document.getElementById(`slave_offset`);const slave_send_btn=document.getElementById(`slave_send_btn`);const slave_clear_btn=document.getElementById(`slave_clear_btn`);const node_btns=document.getElementsByClassName(`node-btn`);const node_devices=document.getElementById(`node_devices`);const node_response=document.getElementById(`node_response`);var device_ids=[0];var device_profiles=[];const pad=(a,b)=>{a=a.toString();while(a.length<b)a=`0`+ a;return a};const parse_device_ids=a=>{let b=a.map(a=>`<option value="${a}">${a}</option>`);return b};const load_profiles=()=>{fetch(`http://${HOST_IP}/api/mapping`,{method:`GET`}).then(a=>a.json()).then(a=>{device_profiles=a})};const load_devices=()=>{fetch(`http://${HOST_IP}/api/devices`,{method:`GET`}).then(a=>a.json()).then(a=>{device_ids=a.map(a=>a.id);const b=new Set(device_ids);device_ids=Array.from(b);let c=a.map(a=>`<button class="node-btn" slave-id="${a.id}" slave-profile="${a.profile}" onclick="get_data_by_profile(this)">0x${pad(a.id,3)}</button>`).join(``);node_devices.innerHTML=c})};const get_data_by_profile=a=>{let b=a.getAttribute(`slave-id`);let c=a.getAttribute(`slave-profile`);for(const a of node_btns)a.classList.remove(`active`);a.classList.add(`active`);const d=new URLSearchParams();d.append(`id`,slave_id.value);d.append(`profile`,slave_func.value);fetch(`http://${HOST_IP}/api/node?${d.toString()}`,{method:`GET`}).then(a=>a.json()).then(a=>{let b=device_profiles[c];let d=b.map((b,c)=>`<tr>
                <td>0x${pad(Number(b.offset),5)}</td>
                <td>0x0${Number(b.func)}</td>
                <td>${b.key}</td>
                <td>${a[b.key]}</td>
                </tr>`).join(``);node_response.innerHTML=d})};slave_send_btn.onclick=()=>{const a=new URLSearchParams();a.append(`id`,slave_id.value);a.append(`func`,slave_func.value);a.append(`numregs`,slave_numregs.value);a.append(`offset`,slave_offset.value);fetch(`http://${HOST_IP}/api/key?${a.toString()}`,{method:`GET`}).then(a=>a.json()).then(a=>{let b=a.data.map((a,b)=>`<tr>
                <td>0x${pad(Number(b)+ Number(slave_offset.value),5)}</td>
                <td>${Number(a)}</td>
                </tr>`).join(``);slave_response.innerHTML=b})};slave_clear_btn.onclick=()=>{slave_response.innerHTML=null;slave_id.value=0;slave_func.value=4;slave_numregs.value=1;slave_offset.value=0};load_devices();load_profiles()</script></html>