document.addEventListener("DOMContentLoaded",function(){const X=document.querySelectorAll(".menu-section ul li a"),Be=document.querySelectorAll(".content-section");X.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),X.forEach(e=>e.classList.remove("active")),e.classList.add("active"),Be.forEach(e=>{e.classList.remove("active")});const s=e.getAttribute("href").substring(1),n=document.getElementById(s);n&&n.classList.add("active")})});const Ee=document.querySelectorAll(".node-btn"),Ce={"0x01":[{address:"0x0000",key:"Voltage value",value:"220"},{address:"0x0001",key:"Current value",value:"1"},{address:"0x0002",key:"Power value",value:"220"},{address:"0x0003",key:"Energy value",value:"10"},{address:"0x0004",key:"Frequency value",value:"50"}],"0x02":[{address:"0x0000",key:"Voltage value",value:"221"},{address:"0x0001",key:"Current value",value:"1.2"},{address:"0x0002",key:"Power value",value:"225"},{address:"0x0003",key:"Energy value",value:"12"},{address:"0x0004",key:"Frequency value",value:"50"}]};Ee.forEach(e=>{e.addEventListener("click",()=>{Ee.forEach(e=>e.classList.remove("active")),e.classList.add("active");const t=e.textContent,n=Ce[t]||Ce["0x01"];Ve(n)})});function Ve(e){const t=document.querySelector("#map-ping .node-navigation + table tbody");t&&(t.innerHTML=e.map(e=>`
              <tr>
                  <td>${e.address}</td>
                  <td>${e.key}</td>
                  <td>${e.value}</td>
              </tr>
          `).join(""))}const Oe=document.querySelectorAll(".tab-btn"),$e=document.querySelectorAll(".tab-content");Oe.forEach(e=>{e.addEventListener("click",()=>{Oe.forEach(e=>e.classList.remove("active")),$e.forEach(e=>e.style.display="none"),e.classList.add("active");const t=e.getAttribute("data-tab");document.getElementById(`${t}-tab`).style.display="block"})});const Ke=document.querySelector(".ntp-servers"),i=document.querySelector(".add-server-btn");i&&i.addEventListener("click",()=>{const e=document.createElement("div");e.className="server-entry",e.innerHTML=`
              <input type="text" value="">
              <button class="remove-btn">-</button>
          `,Ke.insertBefore(e,i);const t=e.querySelector(".remove-btn");t.addEventListener("click",()=>{e.remove()})}),document.querySelectorAll(".remove-btn").forEach(e=>{e.addEventListener("click",()=>{e.parentElement.remove()})});const ve=document.querySelector(".save-btn");ve&&ve.addEventListener("click",()=>{const e={hostname:document.querySelector('input[value="esp8266"]').value,timezone:document.querySelector('input[value="UTC"]').value,ntpEnabled:document.querySelector('input[type="checkbox"]').checked,ntpServers:Array.from(document.querySelectorAll(".server-entry input")).map(e=>e.value)};console.log("Saving configuration:",e),alert("Configuration saved successfully!")});const me=document.querySelector(".reset-btn");me&&me.addEventListener("click",()=>{confirm("Are you sure you want to reset all settings?")&&(document.querySelectorAll('input[type="text"]').forEach(e=>{e.value=e.defaultValue}),document.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.checked=e.defaultChecked}))});const oe=document.querySelector(".sync-btn");oe&&oe.addEventListener("click",()=>{const e=new Date;document.querySelector('input[value*="2024"]').value=e.toLocaleString(),alert("Time synchronized with NTP server")});const ne=document.querySelectorAll(".menu-header");ne.forEach(e=>{e.addEventListener("click",()=>{ne.forEach(e=>e.classList.remove("active")),e.classList.add("active")})});const te=document.getElementById("admin-save-btn"),q=document.getElementById("admin-reset-btn"),p=document.getElementById("admin-username"),c=document.getElementById("admin-password");te&&q&&p&&c&&(te.addEventListener("click",()=>{alert(`Saved!
Username: ${p.value}
Password: ${c.value}`)}),q.addEventListener("click",()=>{p.value="admin",c.value="admin"}));const ie=document.getElementById("wan-save-btn"),b=document.getElementById("wan-reset-btn"),j=document.getElementById("wan-dhcp1"),y=document.getElementById("wan-dhcp2"),_=document.getElementById("wan-ip"),w=document.getElementById("wan-mask"),O=document.getElementById("wan-gateway"),x=document.getElementById("wan-dns");ie&&b&&(ie.addEventListener("click",()=>{alert(`Saved!
DHCP: ${j.value}, ${y.value}
Wan IP: ${_.value}
Subnet Mask: ${w.value}
Gateway: ${O.value}
DNS: ${x.value}`)}),b.addEventListener("click",()=>{j.value="True",y.value="True",_.value="10.10.1.34",w.value="255.255.255.0",O.value="10.10.1.1",x.value="8.8.8.8"}));const C=document.getElementById("lan-save-btn"),E=document.getElementById("lan-reset-btn"),k=document.getElementById("lan-ip"),A=document.getElementById("lan-mask"),S=document.getElementById("lan-dhcp1"),M=document.getElementById("lan-dhcp2");C&&E&&(C.addEventListener("click",()=>{alert(`Saved!
Lan IP: ${k.value}
Subnet Mask: ${A.value}
DHCP Server: ${S.value}, ${M.value}`)}),E.addEventListener("click",()=>{k.value="10.10.2.1",A.value="255.255.255.0",S.value="True",M.value="False"}));const F=document.getElementById("wifi-save-btn"),T=document.getElementById("wifi-reset-btn"),z=document.getElementById("wifi-mode"),D=document.getElementById("sta-ssid"),N=document.getElementById("sta-key"),L=document.getElementById("wifi-mask"),R=document.getElementById("wifi-dhcp"),P=document.getElementById("ap-ssid"),H=document.getElementById("ap-key"),I=document.getElementById("ap-channel");F&&T&&(F.addEventListener("click",()=>{alert(`Saved!
WiFi Mode: ${z.value}
STA SSID: ${D.value}
STA Key: ${N.value}
Subnet Mask: ${L.value}
DHCP Server: ${R.value}
AP SSID: ${P.value}
AP Key: ${H.value}
AP Channel: ${I.value}`)}),T.addEventListener("click",()=>{z.value="Gateway",D.value="MIND",N.value="12345678",L.value="255.255.255.0",R.value="True",P.value="MIND",H.value="12345678",I.value="AUTO"}));const B=document.getElementById("comm-save-btn"),V=document.getElementById("comm-reset-btn"),$=["comm-proto1","comm-proto2","comm-proto3","comm-server","comm-server2","comm-port1","comm-port2","comm-buf1","comm-buf2","comm-keep1","comm-keep2","comm-timeout1","comm-timeout2","comm-connect1","comm-connect2","comm-reg1","comm-reg2","comm-mqttver1","comm-mqttver2","comm-client1","comm-client2","comm-acc1","comm-acc2","comm-pass1","comm-pass2","comm-heart1","comm-heart2","comm-heartcode1","comm-heartcode2","comm-hearttime1","comm-hearttime2","comm-maxaccept1","comm-maxaccept2","comm-topic1","comm-topic2","comm-qos1","comm-qos2","comm-pubtopic","comm-pubqos","comm-pingperiod"],Ye={"comm-proto1":"Things board","comm-proto2":"MQTT","comm-proto3":"Modbus TCP","comm-server":"localhost","comm-server2":"","comm-port1":"1883","comm-port2":"502","comm-buf1":"512","comm-buf2":"512","comm-keep1":"60","comm-keep2":"60","comm-timeout1":"0","comm-timeout2":"0","comm-connect1":"Always","comm-connect2":"Always","comm-reg1":"Disable","comm-reg2":"Disable","comm-mqttver1":"3","comm-mqttver2":"3","comm-client1":"xxxxxxxxx","comm-client2":"xxxxxxxxx","comm-acc1":"xxxxxxxxx","comm-acc2":"xxxxxxxxx","comm-pass1":"xxxxxxxxx","comm-pass2":"xxxxxxxxx","comm-heart1":"True","comm-heart2":"True","comm-heartcode1":"xxxxxxxxx","comm-heartcode2":"xxxxxxxxx","comm-hearttime1":"60","comm-hearttime2":"60","comm-maxaccept1":"","comm-maxaccept2":"3","comm-topic1":"xxxxxxxxx","comm-topic2":"xxxxxxxxx","comm-qos1":"0","comm-qos2":"0","comm-pubtopic":"xxxxxxxxx","comm-pubqos":"0","comm-pingperiod":"0"};B&&V&&(B.addEventListener("click",()=>{let e="Saved!";$.forEach(t=>{const n=document.getElementById(t);n&&(e+=`
${t}: ${n.value}`)}),alert(e)}),V.addEventListener("click",()=>{$.forEach(e=>{const t=document.getElementById(e);t&&(t.value=Ye[e])})}));const U=document.getElementById("console-refresh-btn"),K=document.getElementById("console-clear-btn"),e=document.getElementById("console-log");U&&K&&e&&(U.addEventListener("click",()=>{const t=new Date,n=`MS;P0=${Math.floor(Math.random()*1e4)};P1=${Math.floor(Math.random()*1e4)};T=${t.toLocaleTimeString()};<br>`;e.innerHTML+=n,e.scrollTop=e.scrollHeight}),K.addEventListener("click",()=>{e.innerHTML=""}));const Y=document.getElementById("tasks-save-btn"),G=document.getElementById("tasks-reset-btn"),g=document.getElementById("task-type"),Q=document.getElementById("task-name"),Z=document.getElementById("task-cycle"),J=document.getElementById("task-topic"),ee=document.getElementById("task-frame");Y&&G&&(Y.addEventListener("click",()=>{alert(`Saved!
Task type: ${g.value}
Task name: ${Q.value}
Execute cycle: ${Z.value}
Topic: ${J.value}
Frame: ${ee.value}`)}),G.addEventListener("click",()=>{g.value="Send MQTT",Q.value="Send device attribute",Z.value="Cron",J.value="v1/gateway/attributes",ee.value='{ "Device A": {  "attribute1":"value1",  "attribute2": 42 }, "Device B": {  "attribute1": "value1",  "attribute2": 42 }}'})),document.querySelectorAll(".edit-task").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),alert("Edit task (demo)")})}),document.querySelectorAll(".delete-task").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),alert("Delete task (demo)")})});const s=document.getElementById("tasks-add-btn"),h=document.getElementById("tasks-form"),se=document.getElementById("tasks-back-btn"),u=document.getElementById("tasks-list-table-wrapper");s&&h&&se&&u&&(s.addEventListener("click",()=>{h.style.display="",u.style.display="none",s.style.display="none"}),se.addEventListener("click",()=>{h.style.display="none",u.style.display="",s.style.display=""}));const v=document.getElementById("modbus-poll-save-btn"),ae=document.getElementById("modbus-poll-reset-btn"),re=document.getElementById("modbus-slave-id"),ce=document.getElementById("modbus-address-mode"),le=document.getElementById("modbus-funtion"),de=document.getElementById("modbus-address"),ue=document.getElementById("modbus-quantity");v&&ae&&(v.addEventListener("click",()=>{alert(`Saved!
Slave ID: ${re.value}
Address Mode: ${ce.value}
Funtion: ${le.value}
Address: ${de.value}
Quantity: ${ue.value}`)}),ae.addEventListener("click",()=>{re.value="0",ce.value="DEC",le.value="4x",de.value="0",ue.value="10"}));const he=document.querySelectorAll(".modbus-node-btn"),d=document.getElementById("modbus-node-tbody"),fe={"0x01":[{group:0,addr:"0x0000",key:"Voltage value",value:220},{group:0,addr:"0x0001",key:"Current value",value:1},{group:0,addr:"0x0002",key:"Power value",value:220},{group:0,addr:"0x0003",key:"Energy value",value:10}],"0x02":[{group:0,addr:"0x0000",key:"Voltage value",value:221},{group:0,addr:"0x0001",key:"Current value",value:1.2},{group:0,addr:"0x0002",key:"Power value",value:225},{group:0,addr:"0x0003",key:"Energy value",value:12}]};function pe(e){const t=fe[e]||fe["0x01"];d.innerHTML=t.map(e=>`
          <tr>
              <td>${e.group}</td><td>${e.addr}</td><td>${e.key}</td><td>${e.value}</td>
              <td><a href="#" class="edit-modbus">edit</a> <a href="#" class="delete-modbus" style="color:red;">delete</a></td>
          </tr>
      `).join(""),qe()}function qe(){d.querySelectorAll(".edit-modbus").forEach(e=>{e.onclick=function(e){e.preventDefault(),alert("Edit modbus row (demo)")}}),d.querySelectorAll(".delete-modbus").forEach(e=>{e.onclick=function(e){e.preventDefault(),alert("Delete modbus row (demo)")}})}he.forEach(e=>{e.addEventListener("click",()=>{he.forEach(e=>e.classList.remove("active")),e.classList.add("active"),pe(e.textContent)})}),pe("0x01");const t=document.getElementById("modbus-node-add-btn"),o=document.getElementById("modbus-node-form"),je=document.getElementById("modbus-node-back-btn"),Ue=document.getElementById("modbus-node-save-btn"),We=document.getElementById("modbus-node-reset-btn"),n=document.getElementById("modbus-node-table-wrapper"),a=document.getElementById("modbus-form-slaveid"),r=document.getElementById("modbus-form-addrmode"),l=document.getElementById("modbus-form-funtion"),m=document.getElementById("modbus-form-address"),f=document.getElementById("modbus-form-quantity");t&&o&&je&&n&&(t.addEventListener("click",()=>{o.style.display="",n.style.display="none",t.style.display="none",a.value="",r.value="",l.value="",m.value="",f.value=""}),je.addEventListener("click",()=>{o.style.display="none",n.style.display="",t.style.display=""}),Ue.addEventListener("click",()=>{alert(`Saved!
SlaveID: ${a.value}
Address Mode: ${r.value}
Funtion: ${l.value}
Address: ${m.value}
Quantity: ${f.value}`),o.style.display="none",n.style.display="",t.style.display=""}),We.addEventListener("click",()=>{a.value="",r.value="",l.value="",m.value="",f.value=""}));const Ae=document.querySelectorAll(".serial-tab-btn"),Se=document.getElementById("serial-basic-form"),Me=document.getElementById("serial-advanced-form");Ae.forEach(e=>{e.addEventListener("click",()=>{Ae.forEach(e=>e.classList.remove("active")),e.classList.add("active"),e.dataset.tab==="basic"?(Se.style.display="",Me.style.display="none"):(Se.style.display="none",Me.style.display="")})});const Fe=document.getElementById("serial-basic-save-btn"),Te=document.getElementById("serial-basic-reset-btn"),ze=document.getElementById("serial-basic-buffer"),De=document.getElementById("serial-basic-gap"),Ne=document.getElementById("serial-basic-flow"),Le=document.getElementById("serial-basic-cli"),Re=document.getElementById("serial-basic-proto");Fe&&Te&&(Fe.addEventListener("click",()=>{alert(`Saved!
Buffer Size: ${ze.value}
Gap Time: ${De.value}
Flow Control: ${Ne.value}
Cli: ${Le.value}
Protocol: ${Re.value}`)}),Te.addEventListener("click",()=>{ze.value="512",De.value="50",Ne.value="Disable",Le.value="Disable",Re.value="Modbus"}));const Pe=document.getElementById("serial-adv-save-btn"),He=document.getElementById("serial-adv-reset-btn"),Ie=document.getElementById("serial-adv-baud"),ke=document.getElementById("serial-adv-data"),xe=document.getElementById("serial-adv-stop"),we=document.getElementById("serial-adv-parity");Pe&&He&&(Pe.addEventListener("click",()=>{alert(`Saved!
Baud Rate: ${Ie.value}
Data Bit: ${ke.value}
Stop Bit: ${xe.value}
Parity: ${we.value}`)}),He.addEventListener("click",()=>{Ie.value="9600",ke.value="8",xe.value="1",we.value="None"}));const _e=document.getElementById("reboot-perform-btn");_e&&_e.addEventListener("click",()=>{alert("Rebooting device... (demo)")});const ye=document.getElementById("backup-generate-btn"),be=document.getElementById("backup-upload-btn"),ge=document.getElementById("backup-reset-btn"),W=document.getElementById("backup-flash-btn");ye&&ye.addEventListener("click",()=>alert("Generating archive... (demo)")),be&&be.addEventListener("click",()=>alert("Uploading archive... (demo)")),ge&&ge.addEventListener("click",()=>alert("Factory reset... (demo)")),W&&W.addEventListener("click",()=>alert("Flashing firmware... (demo)"))})